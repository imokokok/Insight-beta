# 链间流动性深度分析 - 产品需求文档

## Overview
- **Summary**: 将现有的跨链套利机会功能改造为链间流动性深度分析功能，提供多条链上主要资产的流动性分布、深度、滑点等关键指标的分析和可视化。
- **Purpose**: 解决套利机会功能不现实的问题，转向更有实际价值的流动性分析，帮助用户了解市场深度、选择最优交易场所、评估大额交易的价格影响。
- **Target Users**: DeFi交易者、流动性提供者、市场分析师、机构投资者

## Goals
- 替换现有的模拟套利机会功能为真实有价值的流动性分析
- 展示多条链上主要资产的流动性分布情况
- 提供流动性深度图表和滑点分析
- 支持按资产、链、时间范围筛选分析
- 提供历史流动性变化趋势

## Non-Goals (Out of Scope)
- 不提供实际的交易执行功能
- 不提供套利交易建议
- 不集成真实的DEX流动性API（当前阶段使用模拟数据）
- 不提供自动路由交易功能

## Background & Context
- 现有代码库是一个通用预言机数据分析平台，已有跨链分析模块
- 当前套利机会功能仅使用模拟数据，实际实现复杂且难以落地
- 代码库已有 `Liquidity` 相关类型定义和基础结构
- 项目使用 Next.js 16 + React 19 + TypeScript + Tailwind CSS

## Functional Requirements
- **FR-1**: 展示多条链上主要资产的总流动性和24小时变化
- **FR-2**: 提供按资产和链筛选的流动性数据
- **FR-3**: 展示各链上前几大流动性池的详细信息
- **FR-4**: 提供流动性深度图表（订单簿深度可视化）
- **FR-5**: 提供不同交易规模下的滑点估算
- **FR-6**: 展示历史流动性变化趋势
- **FR-7**: 提供流动性健康度评分

## Non-Functional Requirements
- **NFR-1**: 页面响应时间 < 2秒
- **NFR-2**: 支持移动端和桌面端响应式布局
- **NFR-3**: 图表支持交互（缩放、悬停查看详情）
- **NFR-4**: 遵循现有代码风格和架构模式

## Constraints
- **Technical**: 使用现有技术栈（Next.js, React, TypeScript, Tailwind CSS, Recharts）
- **Business**: 当前阶段使用模拟数据，不集成真实DEX API
- **Dependencies**: 复用现有的跨链分析基础设施和组件

## Assumptions
- 现有代码库的结构和模式可以复用
- 用户对流动性分析有基本了解
- 模拟数据可以满足演示和初步使用需求
- 未来可以扩展为集成真实数据源

## Acceptance Criteria

### AC-1: 流动性概览卡片展示
- **Given**: 用户打开跨链分析概览页面
- **When**: 页面加载完成
- **Then**: 显示总流动性、24h变化、流动性最高的链、健康度评分等统计卡片
- **Verification**: `programmatic`
- **Notes**: 卡片样式与现有统计卡片保持一致

### AC-2: 各链流动性分布展示
- **Given**: 用户查看流动性分析页面
- **When**: 页面加载完成
- **Then**: 显示支持的所有链的流动性数据，包括总流动性、24h变化、平均滑点、主要池等
- **Verification**: `programmatic`

### AC-3: 资产和链筛选功能
- **Given**: 用户在流动性分析页面
- **When**: 用户选择特定资产或链
- **Then**: 数据根据筛选条件更新，仅显示相关的流动性信息
- **Verification**: `programmatic`

### AC-4: 流动性深度图表
- **Given**: 用户查看特定资产的流动性详情
- **When**: 用户打开深度图
- **Then**: 显示可视化的订单簿深度图表，支持交互查看特定价格点的流动性
- **Verification**: `human-judgment`

### AC-5: 滑点估算器
- **Given**: 用户在流动性分析页面
- **When**: 用户输入交易金额
- **Then**: 系统估算在不同链上执行该交易的预期滑点
- **Verification**: `programmatic`

### AC-6: 历史流动性趋势
- **Given**: 用户查看历史数据
- **When**: 用户选择时间范围
- **Then**: 显示选定时间段内的流动性变化趋势图表
- **Verification**: `human-judgment`

### AC-7: 替换套利组件
- **Given**: 用户打开跨链分析页面
- **When**: 页面加载完成
- **Then**: 原有的套利机会组件被替换为流动性分析组件
- **Verification**: `programmatic`

## Open Questions
- [ ] 是否需要在未来集成真实的DEX流动性数据源？
- [ ] 支持的资产和链的列表是否需要可配置？
- [ ] 是否需要导出流动性分析报告的功能？
