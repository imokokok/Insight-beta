# Insight - Oracle Data Analytics Platform - 产品需求文档

## 概述

- **摘要**: Insight 是一个专业的预言机数据分析平台，为 DeFi 协议和数据提供商提供实时聚合、分析和监控功能。平台支持多个预言机协议，提供统一的数据视图和深度分析能力。
- **目的**: 解决去中心化金融市场中预言机数据分散、缺乏统一监控和分析工具的问题，帮助开发者和协议管理者更好地监控预言机健康状况、价格偏差和异常行为。
- **目标用户**: DeFi 协议开发者、预言机节点运营者、数据分析师、风险管理人员

## 目标

- 提供多协议预言机数据的统一聚合和展示
- 实现实时价格监控和偏差分析
- 提供智能告警系统，及时发现异常
- 支持跨链数据分析和比较
- 提供用户友好的可视化界面和报告导出功能

## 非目标 (范围外)

- 不直接运营预言机节点
- 不提供预言机数据的托管服务
- 不实现区块链交易的执行功能
- 不提供 DeFi 协议的智能合约开发工具

## 背景与上下文

- **技术栈**: Next.js 16 + TypeScript + Tailwind CSS + Supabase (PostgreSQL)
- **支持的预言机协议**: Chainlink、Pyth、RedStone、UMA
- **现有功能模块**: 仪表盘、预言机分析、价格比较、跨链分析、数据探索、告警系统
- **部署目标**: Vercel + Supabase

## 功能需求

- **FR-1**: 多协议预言机数据聚合
- **FR-2**: 实时价格监控和历史数据展示
- **FR-3**: 价格偏差分析和异常检测
- **FR-4**: 智能告警系统（邮件、Telegram、Webhook）
- **FR-5**: 跨链数据分析和比较
- **FR-6**: 数据探索和搜索功能
- **FR-7**: 用户仪表板和个性化视图
- **FR-8**: 多语言支持（中英文）
- **FR-9**: 钱包连接和用户身份验证
- **FR-10**: API 接口和文档

## 非功能需求

- **NFR-1**: 性能 - 页面加载时间 < 2 秒，API 响应时间 < 500ms
- **NFR-2**: 可用性 - 系统可用性 ≥ 99.5%
- **NFR-3**: 安全性 - RBAC 权限控制、API 密钥管理、审计日志
- **NFR-4**: 可扩展性 - 支持新增预言机协议的快速集成
- **NFR-5**: 响应式设计 - 支持桌面端和移动端设备

## 约束

- **技术**: 使用 Next.js 16 框架，数据库为 PostgreSQL (Supabase)，不引入额外的复杂技术栈
- **业务**: 上线前必须完成所有核心功能的测试和验证
- **依赖**: Supabase 服务、区块链 RPC 节点、各预言机协议的 API

## 假设

- 用户有基本的 DeFi 和区块链知识
- 系统主要面向专业用户而非普通消费者
- 区块链 RPC 服务可用性稳定
- 各预言机协议的 API 保持稳定

## 验收标准

### AC-1: 预言机数据聚合功能

- **Given**: 用户访问平台
- **When**: 查看仪表板或预言机分析页面
- **Then**: 能够看到来自 Chainlink、Pyth、RedStone、UMA 的数据
- **Verification**: `programmatic`

### AC-2: 实时价格监控

- **Given**: 用户打开价格监控页面
- **When**: 价格数据更新
- **Then**: 页面实时显示最新价格和变化趋势
- **Verification**: `programmatic`

### AC-3: 价格偏差分析

- **Given**: 用户访问偏差分析页面
- **When**: 选择时间范围和协议
- **Then**: 显示价格偏差分布图、趋势图表和异常列表
- **Verification**: `programmatic`

### AC-4: 告警系统

- **Given**: 用户已配置告警规则
- **When**: 触发告警条件
- **Then**: 通过配置的渠道（邮件/Telegram/Webhook）发送告警通知
- **Verification**: `programmatic`

### AC-5: 跨链分析

- **Given**: 用户访问跨链分析页面
- **When**: 选择多个链进行比较
- **Then**: 显示跨链价格比较、相关性分析和套利机会
- **Verification**: `programmatic`

### AC-6: 数据搜索

- **Given**: 用户使用搜索功能
- **When**: 输入关键词
- **Then**: 返回相关的预言机、价格源或协议信息
- **Verification**: `programmatic`

### AC-7: 用户仪表板

- **Given**: 用户登录平台
- **When**: 访问仪表板
- **Then**: 显示个性化的统计数据、图表和快捷操作
- **Verification**: `human-judgment`

### AC-8: 多语言支持

- **Given**: 用户选择语言
- **When**: 切换中英文
- **Then**: 界面文本相应更新
- **Verification**: `programmatic`

### AC-9: 钱包连接

- **Given**: 用户点击连接钱包
- **When**: 完成钱包连接
- **Then**: 显示用户地址和相关信息
- **Verification**: `programmatic`

### AC-10: API 文档

- **Given**: 用户访问 API 文档页面
- **When**: 浏览文档
- **Then**: 显示完整的 API 接口说明和示例
- **Verification**: `human-judgment`

## 开放问题

- [ ] 是否需要支持更多预言机协议？
- [ ] 是否需要实现用户账户系统（非钱包连接）？
- [ ] 数据保留策略是什么？历史数据需要保留多长时间？
