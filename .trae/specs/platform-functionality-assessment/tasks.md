# 平台功能评估 - 任务列表

## [x] 任务 1: 告警规则持久化

- **优先级**: P0
- **依赖**: 无
- **描述**:
  - 将告警规则从内存 mock 数据改为数据库持久化
  - 确保规则创建、更新、删除操作正确写入数据库
- **验收标准**:
  - 告警规则重启后不丢失
  - CRUD 操作正常工作
- **子任务**:
  - [x] 1.1 验证 `alert_rules` 表是否存在
  - [x] 1.2 修改 `/api/alerts/rules/route.ts` 使用数据库
  - [x] 1.3 修改 `/api/alerts/rules/[id]/route.ts` 使用数据库
  - [x] 1.4 测试规则的增删改查

## [x] 任务 2: 定时任务自动化

- **优先级**: P0
- **依赖**: 无
- **描述**:
  - 配置价格采集定时任务（每5分钟）
  - 配置可靠性评分计算定时任务（每日）
- **验收标准**:
  - 价格数据自动采集
  - 可靠性评分自动计算
- **子任务**:
  - [x] 2.1 配置 Vercel Cron Jobs 或外部调度
  - [x] 2.2 添加 `vercel.json` cron 配置
  - [x] 2.3 验证定时任务执行日志

## [x] 任务 3: 通知发送验证

- **优先级**: P1
- **依赖**: 无
- **描述**:
  - 验证 Telegram 通知发送逻辑
  - 验证 Email 通知发送逻辑
  - 验证 Webhook 通知发送逻辑
- **验收标准**:
  - 测试通知能成功发送
  - 错误处理完善
- **子任务**:
  - [x] 3.1 检查 Telegram 发送实现
  - [x] 3.2 检查 Email 发送实现
  - [x] 3.3 检查 Webhook 发送实现
  - [x] 3.4 完善错误处理和日志

## [x] 任务 4: 数据导出功能验证

- **优先级**: P1
- **依赖**: 无
- **描述**:
  - 验证偏差分析页面的导出功能
  - 确保导出数据格式正确
- **验收标准**:
  - CSV 导出正常
  - JSON 导出正常
- **子任务**:
  - [x] 4.1 测试偏差分析导出功能
  - [x] 4.2 测试告警历史导出功能
  - [x] 4.3 修复发现的问题

## [ ] 任务 5: 用户偏好持久化

- **优先级**: P2
- **依赖**: 无
- **描述**:
  - 存储用户的筛选条件偏好
  - 存储用户的时间范围偏好
- **验收标准**:
  - 用户偏好刷新后保留
- **子任务**:
  - [ ] 5.1 设计用户偏好存储方案
  - [ ] 5.2 实现偏好存储和读取
  - [ ] 5.3 集成到各页面

---

# 任务依赖关系

```
任务 1 (告警持久化) ─┐
任务 2 (定时任务)   ─┼── 任务 5 (用户偏好)
任务 3 (通知验证)   ─┤
任务 4 (导出验证)   ─┘
```

# 可并行执行的任务

- 任务 1、2、3、4 可并行执行
- 任务 5 依赖其他任务完成后再考虑
