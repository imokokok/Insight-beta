# 数据展示架构优化评估 Spec

## Why

参照 Dune Analytics、Nansen、DeFiLlama、Arkham、DEX Screener 等主流Web3数据分析平台的UI架构设计，评估当前Oracle数据分析平台的数据展示形式，找出可以优化页面可观性的地方。

## What Changes

- 评估数据卡片布局优化方案
- 评估图表可视化增强方案
- 评估数据对比功能
- 评估页面信息密度优化

## Impact

- Affected specs: ui-optimization-assessment (已完成)
- Affected code:
  - `src/features/oracle/dashboard/`
  - `src/features/comparison/`
  - `src/features/oracle/analytics/`
  - `src/components/charts/`

## 当前数据展示架构分析

### 1. Dashboard页面

**当前结构**：

- 统计卡片组（系统健康 + 网络规模）
- 图表Tab切换（overview/trends/comparison）
- 图表类型：面积图、折线图、柱状图

**优点**：

- 信息层次清晰
- Tab切换减少页面复杂度
- 响应式设计完善

**可优化点**：

- 缺少关键指标快速概览（顶部KPI条）
- 图表不支持全屏查看
- 缺少数据对比功能（协议对比、时间对比）

### 2. Comparison页面

**当前结构**：

- 视图切换（heatmap/latency/cost/realtime/table）
- 价格热力图、延迟分析、成本效率、实时比较、虚拟表格

**优点**：

- 多视图满足不同分析需求
- 热力图直观展示价格偏差
- 实时数据支持WebSocket

**可优化点**：

- 热力图缺少协议筛选高亮
- 缺少数据导出为图片功能
- 表格数据不支持行详情展开

### 3. Deviation页面

**当前结构**：

- 统计摘要卡片
- Tab切换（overview/trends/anomalies）
- 趋势列表 + 异常列表 + 详情面板

**优点**：

- 左右分栏布局适合详情查看
- 异常检测功能完善
- 帮助提示系统完善

**可优化点**：

- 趋势列表和详情面板比例固定，不支持调整
- 缺少趋势对比功能（多协议对比）
- 异常列表缺少严重程度排序

### 4. Explore页面

**当前结构**：

- 快捷入口
- Tab切换（market-overview/trending/protocols/address/discovery）
- 热门交易对卡片网格

**优点**：

- 卡片式布局直观
- 快捷入口方便导航
- 搜索功能完善

**可优化点**：

- 缺少收藏夹功能
- 卡片布局固定，不支持自定义
- 缺少历史记录功能

### 5. Cross-chain页面

**当前结构**：

- 统计卡片组
- 套利机会列表
- 桥状态卡片
- 流动性分布 + 风险评分

**优点**：

- 信息密度适中
- 链健康状态可视化
- 套利机会实时更新

**可优化点**：

- 缺少跨链价格对比图表
- 流动性分布图表可增强交互
- 缺少套利历史记录

## 主流平台UI架构参考

### Dune Analytics

- **卡片化展示**：查询结果以卡片形式展示，支持自定义排列
- **网格布局**：灵活的网格系统，支持拖拽重排
- **数据表格**：支持排序、筛选、分页、导出

### DeFiLlama

- **TVL排行榜**：简洁的表格展示，支持多维度排序
- **协议比较**：并排比较多个协议
- **链级分布**：饼图 + 表格组合展示

### DEX Screener

- **实时图表**：TradingView风格，支持缩放、绘图
- **时间范围**：底部快捷按钮（1m/5m/15m/1H/4H/1D/1W）
- **紧凑布局**：信息密度高，一屏展示关键数据

### Arkham

- **实体图谱**：可视化展示地址关系
- **标签系统**：地址标签、实体标签
- **实时数据流**：交易流实时更新

## 优化建议评估

### 优先级：高

#### 1. 顶部KPI快速概览条

**参考**：DeFiLlama、DEX Screener
**建议**：

- 在Dashboard页面顶部添加KPI概览条
- 展示关键指标：总TVL、活跃协议数、平均延迟、健康评分
- 支持点击跳转到详情

**价值**：用户无需滚动即可获取关键信息

#### 2. 图表全屏查看

**参考**：Dune Analytics、TradingView
**建议**：

- 为所有图表添加全屏按钮
- 全屏模式下支持更大尺寸查看
- 支持ESC退出

**价值**：提升数据查看体验，适合演示场景

#### 3. 数据对比功能

**参考**：DeFiLlama Protocol Compare
**建议**：

- 添加协议对比功能
- 支持选择2-4个协议进行并排对比
- 对比维度：延迟、准确率、更新频率、价格偏差

**价值**：帮助用户快速选择最优数据源

### 优先级：中

#### 4. 收藏夹功能

**参考**：DEX Screener、Nansen
**建议**：

- 支持收藏交易对、协议、地址
- 收藏内容在侧边栏快速访问
- 支持收藏分组

**价值**：提升用户粘性，方便快速访问关注内容

#### 5. 图表导出功能

**参考**：Dune Analytics
**建议**：

- 支持导出图表为PNG/SVG
- 支持导出数据为CSV/JSON
- 导出时包含水印和时间戳

**价值**：方便用户分享和存档

#### 6. 数据表格行详情展开

**参考**：Dune Analytics
**建议**：

- 点击表格行展开详情面板
- 展示该数据点的详细信息
- 支持查看历史趋势

**价值**：减少页面跳转，提升查看效率

### 优先级：低

#### 7. 可拖拽卡片布局

**参考**：Dune Analytics Dashboard
**建议**：

- 支持拖拽重排卡片位置
- 支持调整卡片大小
- 保存用户布局偏好

**价值**：个性化体验，但实现复杂度高

#### 8. 历史记录功能

**参考**：Nansen
**建议**：

- 记录用户查看过的页面/数据
- 在侧边栏显示最近访问
- 支持清除历史

**价值**：方便回溯，但优先级较低

## 不建议优化的部分

### 1. 复杂图表交互（绘图工具、技术指标）

- 非核心功能
- 实现复杂度高
- Recharts不支持

### 2. 自定义仪表盘

- 实现复杂度高
- 用户需求不明确
- 维护成本高

### 3. 社交功能（分享、评论）

- 非数据分析平台核心功能
- 增加复杂度

## ADDED Requirements

### Requirement: 顶部KPI快速概览条

系统应在Dashboard页面顶部提供KPI快速概览条，展示关键指标。

#### Scenario: KPI概览展示

- **WHEN** 用户访问Dashboard页面
- **THEN** 顶部显示KPI概览条，包含总TVL、活跃协议数、平均延迟、健康评分

#### Scenario: KPI点击跳转

- **WHEN** 用户点击KPI指标
- **THEN** 页面滚动到对应的详情区域

### Requirement: 图表全屏查看

系统应支持图表全屏查看功能。

#### Scenario: 进入全屏

- **WHEN** 用户点击图表全屏按钮
- **THEN** 图表以全屏模式展示，尺寸更大

#### Scenario: 退出全屏

- **WHEN** 用户按ESC键或点击关闭按钮
- **THEN** 退出全屏模式，恢复正常显示

### Requirement: 协议对比功能

系统应提供协议对比功能，支持多维度对比。

#### Scenario: 选择对比协议

- **WHEN** 用户选择2-4个协议进行对比
- **THEN** 显示并排对比视图，展示延迟、准确率、更新频率、价格偏差

#### Scenario: 对比结果可视化

- **WHEN** 对比数据加载完成
- **THEN** 以表格和图表形式展示对比结果

## MODIFIED Requirements

无

## REMOVED Requirements

无
